{"version":3,"sources":["components/header/index.js","constants/colors.js","components/loader/index.js","../../display/dist/constants/index.js","../../display/dist/utils/index.js","../../display/dist/pitch-display/index.js","components/pitch/index.js","App.js","serviceWorker.js","bootstrap.js","components/loader/play.svg","components/pitch/stop.svg","../../wasm/pkg/pitch_detection_wasm_bg.js"],"names":["header","_ref","onClick","loading","react_default","a","createElement","className","style","backgroundColor","color","loader","detectorName","sampleRate","windowSize","clarityThreshold","onParamChange","onStart","position","textAlign","href","target","value","onChange","e","type","min","max","step","disabled","src","PlayIcon","NOTE_STRINGS","OCTAVE_COLORS","noteFromPitch","frequency","noteNum","Math","log","round","centsOffFromPitch","note","floor","pow","frequencyFromNoteNumber","colorFromNote","octave","idx","length","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","from","test","_unsupportedIterableToArray","i","F","s","done","_e","f","TypeError","err","normalCompletion","didErr","next","_e2","return","arr","len","arr2","pitch_display_PitchDisplay","PitchDisplay","container","timeSpan","arguments","undefined","timeOffset","classCallCheck","this","frequencies","background","highlight","canvasStyle","bgCanvas","document","setAttribute","bgContext","getContext","noteCanvas","noteContext","appendChild","resize","createClass","key","w","clientWidth","h","clientHeight","width","height","scaleX","d3_scale_src","domain","range","margin","scaleY","render","push","_this","filter","val","now","time","full","Date","getTime","cleanupFrequencies","drawBackground","drawNotes","fillStyle","clearRect","fillRect","y","font","fillText","beginPath","strokeStyle","_step","notes","_iterator","t","c","clarity","_note","centsOff","_x2","_y2","_color","x","_notes$i","stroke","moveTo","lineTo","_i","_notes","_x","_y","concat","arc","PI","fill","PitchComponent","quit","mainLoop","requestAnimationFrame","updatePitch","onResize","pitchDisplay","console","displayElement","setBackgroundColor","_this$props","props","stream","detectorClass","detector","new","buffer","Float32Array","result","audioContext","AudioContext","mediaStreamSource","createMediaStreamSource","analyser","createAnalyser","fftSize","connect","window","addEventListener","removeEventListener","_this$props2","powerThreshold","getFloatTimeDomainData","get_pitch","_this$result","slicedToArray","pushFrequency","_this2","onStop","ref","StopIcon","Component","getDetectorClass","AutocorrelationDetector","McLeodDetector","App","possibleConstructorReturn","getPrototypeOf","POWER_THRESHOLD","setState","state","options","audio","echoCancellation","autoGainControl","SAMPLE_RATE","navigator","mediaDevices","getUserMedia","then","loaded","catch","App_createForOfIteratorHelper","getTracks","stop","_this$state","pitch","Boolean","location","hostname","match","ReactDOM","src_App_0","getElementById","serviceWorker","ready","registration","unregister","module","exports","__webpack_require__","p","d","__webpack_exports__","__wbindgen_throw","_home_alessandro_personal_sources_pitch_detection_app_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","_home_alessandro_personal_sources_pitch_detection_app_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","_pitch_detection_wasm_bg_wasm__WEBPACK_IMPORTED_MODULE_2__","cachedTextDecoder","TextDecoder","require","ignoreBOM","fatal","decode","cachegetUint8Memory0","getStringFromWasm0","ptr","Uint8Array","subarray","cachegetFloat32Memory0","getFloat32Memory0","WASM_VECTOR_LEN","passArrayF32ToWasm0","arg","malloc","set","signal","sample_rate","power_threshold","clarity_threshold","ptr0","len0","ptr1","len1","obj","create","size","padding","ret","__wrap","arg0","arg1","Error"],"mappings":"gMAIeA,EAAA,SAAAC,GAA0BA,EAAvBC,QAAuBD,EAAdE,QACzB,OACEC,EAAAC,EAAAC,cAAA,OAAKC,UAAU,SAASC,MAAO,CAACC,gBCJb,UDIuCC,MCDlC,YDCxB,oCEAWC,EAAA,SAAAV,GAAiG,IAA9FW,EAA8FX,EAA9FW,aAAcC,EAAgFZ,EAAhFY,WAAYC,EAAoEb,EAApEa,WAAYC,EAAwDd,EAAxDc,iBAAkBC,EAAsCf,EAAtCe,cAAeC,EAAuBhB,EAAvBgB,QAASd,EAAcF,EAAdE,QAChG,OACEC,EAAAC,EAAAC,cAAA,OAAKC,UAAU,OAAOC,MAAO,CAACC,gBDRR,UCQqCS,SAAU,aACnEd,EAAAC,EAAAC,cAAA,OAAKC,UAAU,UAAUC,MAAO,CAACW,UAAW,WAC1Cf,EAAAC,EAAAC,cAAA,iDAIAF,EAAAC,EAAAC,cAAA,oBAGAF,EAAAC,EAAAC,cAAA,iCAIAF,EAAAC,EAAAC,cAAA,0BAGAF,EAAAC,EAAAC,cAAA,YACEF,EAAAC,EAAAC,cAAA,KAAGc,KAAK,gDAAgDC,OAAO,UAA/D,UACAjB,EAAAC,EAAAC,cAAA,WAFF,UAMAF,EAAAC,EAAAC,cAAA,sBAGAF,EAAAC,EAAAC,cAAA,YACEF,EAAAC,EAAAC,cAAA,KAAGc,KAAK,oDAAoDC,OAAO,UAAnE,UACAjB,EAAAC,EAAAC,cAAA,WAFF,iBAMAF,EAAAC,EAAAC,cAAA,WAEAF,EAAAC,EAAAC,cAAA,sBAGAF,EAAAC,EAAAC,cAAA,UAAQgB,MAAOV,EAAcW,SAAU,SAACC,GAAOR,EAAc,eAAgBQ,EAAEH,OAAOC,SACpFlB,EAAAC,EAAAC,cAAA,UAAQgB,MAAM,UAAd,UACAlB,EAAAC,EAAAC,cAAA,UAAQgB,MAAM,mBAAd,oBAGFlB,EAAAC,EAAAC,cAAA,yBAGAF,EAAAC,EAAAC,cAAA,UAAQgB,MAAOT,EAAYU,SAAU,SAACC,GAAOR,EAAc,aAAcQ,EAAEH,OAAOC,SAChFlB,EAAAC,EAAAC,cAAA,UAAQgB,MAAO,OAAf,YACAlB,EAAAC,EAAAC,cAAA,UAAQgB,MAAO,OAAf,YACAlB,EAAAC,EAAAC,cAAA,UAAQgB,MAAO,OAAf,YACAlB,EAAAC,EAAAC,cAAA,UAAQgB,MAAO,MAAf,aAGFlB,EAAAC,EAAAC,cAAA,yBAGAF,EAAAC,EAAAC,cAAA,UAAQgB,MAAOR,EAAYS,SAAU,SAACC,GAAOR,EAAc,aAAcQ,EAAEH,OAAOC,SAChFlB,EAAAC,EAAAC,cAAA,UAAQgB,MAAO,KAAf,eACAlB,EAAAC,EAAAC,cAAA,UAAQgB,MAAO,MAAf,gBACAlB,EAAAC,EAAAC,cAAA,UAAQgB,MAAO,MAAf,gBACAlB,EAAAC,EAAAC,cAAA,UAAQgB,MAAO,MAAf,iBAGFlB,EAAAC,EAAAC,cAAA,+BAGAF,EAAAC,EAAAC,cAAA,SAAOgB,MAAOP,EAAkBU,KAAK,QAAQC,IAAK,EAAKC,IAAK,EAAKC,KAAM,IAAML,SAAU,SAACC,GAAOR,EAAc,mBAAoBQ,EAAEH,OAAOC,UAC1IlB,EAAAC,EAAAC,cAAA,WAhEF,IAiEIS,EAjEJ,KAoEAX,EAAAC,EAAAC,cAAA,OAAKC,UAAU,6BACbH,EAAAC,EAAAC,cAAA,UACEuB,SAAU1B,EACVD,QAASe,EACTV,UAAU,wBACVC,MAAO,CAACC,gBAAiBN,ED/EN,UADN,UCgF+CO,MD7E1C,YC+ElBN,EAAAC,EAAAC,cAAA,YAAUwB,IAAKC,0BCpFlBC,EAAA,uDACAC,EAAA,mHCAA,SAAAC,EAAAC,GACP,IAAAC,EAAAC,KAAAC,IAAAH,EAAA,KAAAE,KAAAC,IAAA,MACA,OAAAD,KAAAE,MAAAH,GAAA,GAKO,SAAAI,EAAAL,EAAAM,GACP,OAAAJ,KAAAK,MAAA,KAAAL,KAAAC,IAAAH,EAJO,SAAAM,GACP,WAAAJ,KAAAM,IAAA,GAAAF,EAAA,QAGAG,CAAAH,IAAAJ,KAAAC,IAAA,IAEO,SAAAO,EAAAJ,GACP,IAAAK,EAAAT,KAAAK,MAAAD,EAAA,MACAM,EAAAV,KAAAX,IAAAoB,EAA6Bb,EAAae,OAAA,GAE1C,OADAD,EAAAV,KAAAV,IAAA,EAAAoB,GACSd,EAAac,GCZtB,SAAAE,EAAAC,EAAAC,GAAwD,IAAAC,EAAQ,wBAAAC,QAAA,MAAAH,EAAAG,OAAAC,UAAA,CAAmE,GAAAC,MAAAC,QAAAN,KAAAE,EAEnI,SAAAF,EAAAO,GAAiD,IAAAP,EAAA,OAAgB,qBAAAA,EAAA,OAAAQ,EAAAR,EAAAO,GAAgE,IAAAE,EAAAC,OAAAC,UAAAC,SAAAC,KAAAb,GAAAc,MAAA,MAAwD,WAAAL,GAAAT,EAAAe,cAAAN,EAAAT,EAAAe,YAAAC,MAA6D,WAAAP,GAAA,QAAAA,EAAA,OAAAJ,MAAAY,KAAAjB,GAAsD,iBAAAS,GAAA,2CAAAS,KAAAT,GAAA,OAAAD,EAAAR,EAAAO,GAFzKY,CAAAnB,KAAAC,GAAAD,GAAA,kBAAAA,EAAAF,OAAA,CAAwHI,IAAAF,EAAAE,GAAgB,IAAAkB,EAAA,EAAWC,EAAA,aAAyB,OAASC,EAAAD,EAAAZ,EAAA,WAAwB,OAAAW,GAAApB,EAAAF,OAAA,CAA4ByB,MAAA,GAAc,CAASA,MAAA,EAAAnD,MAAA4B,EAAAoB,OAAgC9C,EAAA,SAAAkD,GAAqB,MAAAA,GAAYC,EAAAJ,GAAW,UAAAK,UAAA,yIAAgK,IAAAC,EAAAC,GAAA,EAAAC,GAAA,EAAkD,OAASP,EAAA,WAAkBpB,EAAAF,EAAAG,OAAAC,aAA6BK,EAAA,WAAmB,IAAA/B,EAAAwB,EAAA4B,OAAoD,OAA9BF,EAAAlD,EAAA6C,KAA8B7C,GAAeJ,EAAA,SAAAyD,GAAsBF,GAAA,EAAeF,EAAAI,GAAaN,EAAA,WAAmB,IAAMG,GAAA,MAAA1B,EAAA8B,QAAA9B,EAAA8B,SAA2D,QAAU,GAAAH,EAAA,MAAAF,KAI/7B,SAAAnB,EAAAyB,EAAAC,IAAsC,MAAAA,KAAAD,EAAAnC,UAAAoC,EAAAD,EAAAnC,QAAuD,QAAAsB,EAAA,EAAAe,EAAA,IAAA9B,MAAA6B,GAAuCd,EAAAc,EAASd,IAAOe,EAAAf,GAAAa,EAAAb,GAAoB,OAAAe,EAMxK,IAAIC,EAAY,WAChB,SAAAC,EAAAC,GACA,IAAAC,EAAAC,UAAA1C,OAAA,QAAA2C,IAAAD,UAAA,GAAAA,UAAA,QACAE,EAAAF,UAAA1C,OAAA,QAAA2C,IAAAD,UAAA,GAAAA,UAAA,OAEI9B,OAAAiC,EAAA,EAAAjC,CAAekC,KAAAP,GAEnBO,KAAAC,YAAA,GACAD,KAAAE,WAAA,UACAF,KAAAG,UAAA,UACAH,KAAAN,YACAM,KAAAN,UAAAhF,MAAAU,SAAA,WACA,IAAAgF,EAAA,iDACAJ,KAAAK,SAAAC,SAAA9F,cAAA,UACAwF,KAAAK,SAAAE,aAAA,QAAAH,GACAJ,KAAAQ,UAAAR,KAAAK,SAAAI,WAAA,MACAT,KAAAU,WAAAJ,SAAA9F,cAAA,UACAwF,KAAAU,WAAAH,aAAA,QAAAH,GACAJ,KAAAW,YAAAX,KAAAU,WAAAD,WAAA,MACAT,KAAAN,UAAAkB,YAAAZ,KAAAK,UACAL,KAAAN,UAAAkB,YAAAZ,KAAAU,YACAV,KAAAL,WACAK,KAAAF,aACAE,KAAAa,SAgKA,OA7JE/C,OAAAgD,EAAA,EAAAhD,CAAY2B,EAAA,EACdsB,IAAA,SACAvF,MAAA,WACA,IAAAwF,EAAAhB,KAAAN,UAAAuB,YACAC,EAAAlB,KAAAN,UAAAyB,aACAnB,KAAAK,SAAAe,MAAAJ,EACAhB,KAAAK,SAAAgB,OAAAH,EACAlB,KAAAU,WAAAU,MAAAJ,EACAhB,KAAAU,WAAAW,OAAAH,EACAlB,KAAAsB,OAAoBxD,OAAAyD,EAAA,EAAAzD,GAAW0D,OAAA,EAAAxB,KAAAF,YAAAE,KAAAF,WAAAE,KAAAL,WAAA8B,MAAA,GAAAT,IAC/B,IAAAU,EAAAR,GAAwBhF,EAAYgB,OAAA,GACpC8C,KAAA2B,OAAoB7D,OAAAyD,EAAA,EAAAzD,GAAW0D,OAAA,GAActF,EAAYgB,OAAA,IAAAuE,MAAA,CAAAP,EAAAQ,MACzD1B,KAAA4B,WAEG,CACHb,IAAA,gBACAvF,MAAA,SAAAa,GACA2D,KAAAC,YAAA4B,KAAAxF,KAEG,CACH0E,IAAA,qBACAvF,MAAA,WACA,IAAAsG,EAAA9B,KAGAA,KAAAC,YAAAD,KAAAC,YAAA8B,OAAA,SAAAC,GACA,OAAAF,EAAAG,IAAAD,EAAAE,KAAAJ,EAAAhC,eAGG,CACHiB,IAAA,SACAvF,MAAA,WACA,IAAA2G,IAAAvC,UAAA1C,OAAA,QAAA2C,IAAAD,UAAA,KAAAA,UAAA,GACAI,KAAAiC,KAAA,IAAAG,MAAAC,UACArC,KAAAsC,qBAEAH,GACAnC,KAAAuC,iBAGAvC,KAAAwC,cAEG,CACHzB,IAAA,qBACAvF,MAAA,SAAAZ,GACAoF,KAAAE,WAAAtF,EACAoF,KAAAuC,mBAEG,CACHxB,IAAA,oBACAvF,MAAA,SAAAZ,GACAoF,KAAAG,UAAAvF,EACAoF,KAAAuC,mBAEG,CACHxB,IAAA,iBACAvF,MAAA,WACA,IAAAwF,EAAAhB,KAAAK,SAAAe,MACAF,EAAAlB,KAAAK,SAAAgB,OACArB,KAAAQ,UAAAiC,UAAAzC,KAAAE,WACAF,KAAAQ,UAAAkC,UAAA,IAAA1B,EAAAE,GACAlB,KAAAQ,UAAAmC,SAAA,IAAA3B,EAAAE,GAEA,QAAA1C,EAAA,EAAqBA,EAAKtC,EAAYgB,SAAQsB,EAAA,CAC9C,IAAAoE,EAAA5C,KAAA2B,OAAAnD,GACAwB,KAAAQ,UAAAiC,UAAAzC,KAAAG,UAAA,KACAH,KAAAQ,UAAAmC,SAAA,EAAAC,EAAA5B,EAAA,GACAhB,KAAAQ,UAAAiC,UAAAzC,KAAAG,UACAH,KAAAQ,UAAAqC,KAAA,YACA7C,KAAAQ,UAAAsC,SAAgC5G,EAAYsC,GAAAwB,KAAAsB,OAAA,MAAAsB,EAAA,GAC5C5C,KAAAQ,UAAAsC,SAAgC5G,EAAYsC,GAAA,GAAAoE,EAAA,GAG5C5C,KAAAQ,UAAAiC,UAAAzC,KAAAG,UAAA,KACAH,KAAAQ,UAAAmC,SAAA3C,KAAAsB,OAAA,OAAAJ,KAEG,CACHH,IAAA,YACAvF,MAAA,WACA,IAAAwF,EAAAhB,KAAAU,WAAAU,MACAF,EAAAlB,KAAAU,WAAAW,OACArB,KAAAW,YAAA+B,UAAA,IAAA1B,EAAAE,GACAlB,KAAAW,YAAAoC,YACA/C,KAAAW,YAAAqC,YAAA,qBAEA,IAGAC,EAHAC,EAAA,GAEAC,EAAAhG,EAAA6C,KAAAC,aAGA,IACA,IAAAkD,EAAAzE,MAA2BuE,EAAAE,EAAAtF,KAAAc,MAA+B,CAC1D,IAAAtC,EAAA4G,EAAAzH,MACA4H,EAAA/G,EAAA6F,KACArD,EAAAxC,YACAgH,EAAAhH,EAAAiH,QAEAC,EAAsBnH,EAAayC,GAEnC2E,EAAyB9G,EAAiBmC,EAAA0E,GAE1CE,EAAAzD,KAAAsB,OAAA8B,EAAApD,KAAAiC,KAEAyB,EAAA1D,KAAA2B,OAAA4B,EAAA,GAAAC,EAAA,KAEAG,EAAuB5G,EAAawG,GAEpCL,EAAArB,KAAA,CACAK,KAAAkB,EACAQ,EAAAH,EACAb,EAAAc,EACAJ,QAAAD,EACAzI,MAAA+I,KAIO,MAAA5E,GACPoE,EAAAzH,EAAAqD,GACO,QACPoE,EAAAtE,IAIAmB,KAAAW,YAAAoC,YAEA,QAAAvE,EAAA,EAAqBA,EAAA0E,EAAAhG,SAAkBsB,EAAA,CACvC,IAAAqF,EAAAX,EAAA1E,GACAoF,EAAAC,EAAAD,EACAhB,EAAAiB,EAAAjB,EACAiB,EAAA3B,KACAgB,EAAA1E,EAAA,GAAA0D,KARA,KAWAlC,KAAAW,YAAAmD,SACA9D,KAAAW,YAAAoC,YACA/C,KAAAW,YAAAoD,OAAAH,EAAAhB,IAEA5C,KAAAW,YAAAqD,OAAAJ,EAAAhB,GAIA5C,KAAAW,YAAAmD,SAEA,QAAAG,EAAA,EAAAC,EAAAhB,EAAsCe,EAAAC,EAAAhH,OAAoB+G,IAAA,CAC1D,IAAAtH,EAAAuH,EAAAD,GACAE,EAAAxH,EAAAiH,EACAQ,EAAAzH,EAAAiG,EACAU,EAAA3G,EAAA2G,QACA1I,EAAA+B,EAAA/B,MACAoF,KAAAW,YAAA8B,UAAA,QAAA4B,OAAAzJ,EAAA,SAAAyJ,OAAAzJ,EAAA,SAAAyJ,OAAAzJ,EAAA,SAAAyJ,OAAA,GAAAf,EAAA,KACAtD,KAAAW,YAAAoC,YACA/C,KAAAW,YAAA2D,IAAAH,EAAAC,EAAA,MAAA7H,KAAAgI,IACAvE,KAAAW,YAAA6D,YAKA/E,EAvLgB,oBC4EDgF,6MA1EbC,MAAO,IA6BPC,SAAW,WACL7C,EAAK4C,OAGTE,sBAAsB9C,EAAK6C,UAC3B7C,EAAK+C,kBAGPC,SAAW,WACThD,EAAKiD,aAAalE,6FAjClBmE,QAAQxI,IAAI,2BAA4BiD,GACxCO,KAAK+E,aAAe,IAAItF,EAAaO,KAAKiF,eAAgB,IAAM,KAChEjF,KAAK+E,aAAaG,mBLtBI,WKmBJ,IAAAC,EAI4BnF,KAAKoF,MAA3CC,EAJUF,EAIVE,OAAQC,EAJEH,EAIFG,cAAetK,EAJbmK,EAIanK,WAC/BgF,KAAKuF,SAAWD,EAAcE,IAAIxK,EAAYA,EAAa,GAC3DgF,KAAKyF,OAAS,IAAIC,aAAc1K,GAChCgF,KAAK2F,OAAS,IAAID,aAAa,GAC/B1F,KAAK4F,aAAe,IAAIC,aAExB7F,KAAK8F,kBAAoB9F,KAAK4F,aAAaG,wBAAwBV,GAEnErF,KAAKgG,SAAWhG,KAAK4F,aAAaK,iBAClCjG,KAAKgG,SAASE,QAAUlL,EACxBgF,KAAK8F,kBAAkBK,QAASnG,KAAKgG,UACrCI,OAAOC,iBAAiB,SAAUrG,KAAK8E,UACvC9E,KAAK2E,0DAILK,QAAQxI,IAAI,+BACZ4J,OAAOE,oBAAoB,SAAUtG,KAAK8E,UAC1C9E,KAAK0E,MAAO,wCAeA,IAAA6B,EAC6CvG,KAAKoF,MAAtDrK,EADIwL,EACJxL,WAAYyL,EADRD,EACQC,eAAgBvL,EADxBsL,EACwBtL,iBACpC+E,KAAKgG,SAASS,uBAAuBzG,KAAKyF,QAC1CzF,KAAKuF,SAASmB,UAAU1G,KAAKyF,OAAQ1K,EAAYyL,EAAgBvL,EAAkB+E,KAAK2F,QAH5E,IAAAgB,EAAA7I,OAAA8I,EAAA,EAAA9I,CAIiBkC,KAAK2F,OAJtB,GAILtJ,EAJKsK,EAAA,GAIMrD,EAJNqD,EAAA,GAKZ,GAAItK,EAAY,EAAG,CACjB,IAAM6F,GAAQ,IAAIE,MAAQC,UAC1BrC,KAAK+E,aAAa8B,cAAc,CAACxK,YAAWiH,UAASpB,SAEvDlC,KAAK+E,aAAanD,QAAO,oCAGlB,IAAAkF,EAAA9G,KACC+G,EAAW/G,KAAKoF,MAAhB2B,OACR,OACEzM,EAAAC,EAAAC,cAAA,OAAKC,UAAU,OAAOC,MAAO,CAACU,SAAU,aACtCd,EAAAC,EAAAC,cAAA,OAAKC,UAAU,OAAOC,MAAO,CAACU,SAAU,YACtC4L,IAAK,SAAAA,GAAQF,EAAK7B,eAAiB+B,KAErC1M,EAAAC,EAAAC,cAAA,OAAKC,UAAU,sBACbH,EAAAC,EAAAC,cAAA,UACEJ,QAAS2M,EACTtM,UAAU,kBACVC,MAAO,CAACC,gBLxEK,UKwEuBC,MLrElB,YKuElBN,EAAAC,EAAAC,cAAA,YAAUwB,IAAKiL,gBA1EEC,iiCCE7B,SAASC,EAAiB/I,GACxB,OAAOA,GACL,IAAK,kBACH,OAAOgJ,IAGT,IAAK,SAIL,QACE,OAAOC,SA6HEC,cArHb,SAAAA,EAAYlC,GAAO,IAAAtD,EAAA,OAAAhE,OAAAiC,EAAA,EAAAjC,CAAAkC,KAAAsH,IACjBxF,EAAAhE,OAAAyJ,EAAA,EAAAzJ,CAAAkC,KAAAlC,OAAA0J,EAAA,EAAA1J,CAAAwJ,GAAArJ,KAAA+B,KAAMoF,KAHRqC,gBAAkB,IAEC3F,EAanB3G,QAAU,WACR2G,EAAK4F,SAAS,SAAAC,GAEZ,OADAA,EAAMtN,SAAU,EACTsN,IAGT,IAkBMC,EAAU,CACdC,MAAO,CACLC,kBAAkB,EAClBC,iBAAiB,EACjBhN,WAAY+G,EAAKkG,cAIrBC,UAAUC,aAAaC,aAAaP,GACjCQ,KA3Be,SAAC/C,GACjBvD,EAAK4F,SAAS,SAAAC,GAIZ,OAHAA,EAAMtN,SAAU,EAChBsN,EAAMU,QAAS,EACfV,EAAMtC,OAASA,EACRsC,MAuBRW,MAnBc,SAAC5M,GAChBsJ,QAAQxI,IAAId,GACZoG,EAAK4F,SAAS,SAAAC,GAGZ,OAFAA,EAAMtN,SAAU,EAChBsN,EAAMtC,OAAS,KACRsC,OAjCM7F,EAkDnBiF,OAAS,WAAM,IACL1B,EAAWvD,EAAK6F,MAAhBtC,OACR,GAAIA,EAAQ,KAAApC,EAAAE,EAAAoF,EACQlD,EAAOmD,aADf,IACV,IAAArF,EAAAzE,MAAAuE,EAAAE,EAAAtF,KAAAc,MAAsC,CAAAsE,EAAAzH,MAC9BiN,QAFE,MAAA1J,GAAAoE,EAAAzH,EAAAqD,GAAA,QAAAoE,EAAAtE,KAKZiD,EAAK4F,SAAS,SAAAC,GAGZ,OAFAA,EAAMU,QAAS,EACfV,EAAMtC,OAAS,KACRsC,KA5DQ7F,EAgEnB5G,cAAgB,SAAC6F,EAAKvF,GACpBsG,EAAK4F,SAAS,SAAAC,GAEZ,OADAA,EAAM5G,GAAOvF,EACNmM,KAjET7F,EAAK6F,MAAQ,CACXtN,SAAS,EACTgO,QAAQ,EACRhD,OAAQ,KACRvK,aAAc,SACdC,WAAY,MACZC,WAAY,KACZC,iBAAkB,IATH6G,wEAuEV,IAAA4G,EASH1I,KAAK2H,MAPP7M,EAFK4N,EAEL5N,aACAC,EAHK2N,EAGL3N,WACAC,EAJK0N,EAIL1N,WACAC,EALKyN,EAKLzN,iBACAZ,EANKqO,EAMLrO,QACAgO,EAPKK,EAOLL,OACAhD,EARKqD,EAQLrD,OAEF,OACE/K,EAAAC,EAAAC,cAAA,OAAKC,UAAU,OACbH,EAAAC,EAAAC,cAACN,EAAD,MAEAI,EAAAC,EAAAC,cAAA,OAAKC,UAAU,sBAEX4N,GACF/N,EAAAC,EAAAC,cAACK,EAAD,CACEC,aAAcA,EACdC,WAAYA,EACZC,WAAYA,EACZC,iBAAkBA,EAClBC,cAAe8E,KAAK9E,cACpBC,QAAS6E,KAAK7E,QACdd,QAASA,IAIVgO,GACD/N,EAAAC,EAAAC,cAACmO,EAAD,CACEtD,OAAQA,EACRC,cAAe6B,EAAiBrM,GAChCC,WAAYA,EACZC,WAAYA,EACZwL,eAAgBxG,KAAKyH,gBACrBxM,iBAAkBA,EAClB8L,OAAQ/G,KAAK+G,kBA9GPG,aCbE0B,QACW,cAA7BxC,OAAOyC,SAASC,UAEe,UAA7B1C,OAAOyC,SAASC,UAEhB1C,OAAOyC,SAASC,SAASC,MACvB,2DCZNC,IAASpH,OAAOtH,EAAAC,EAAAC,cAACyO,EAAD,MAAS3I,SAAS4I,eAAe,SD2H3C,kBAAmBjB,WACrBA,UAAUkB,cAAcC,MAAMhB,KAAK,SAAAiB,GACjCA,EAAaC,oFEnInBC,EAAAC,QAAiBC,EAAAC,EAAuB,kDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,gECAxC,SAAAH,GAAAE,EAAAE,EAAAC,EAAA,sBAAAxC,IAAAqC,EAAAE,EAAAC,EAAA,sBAAAvC,IAAAoC,EAAAE,EAAAC,EAAA,sBAAAC,IAAA,IAAAC,EAAAL,EAAA,GAAAM,EAAAN,EAAA,GAAAO,EAAAP,EAAA,IAIAQ,EAAA,IADA,qBAAAC,aAAA,EAAAX,EAAAY,SAAA,QAAAD,yBACA,SACAE,WAAA,EACAC,OAAA,IAEAJ,EAAAK,SACA,IAAAC,EAAA,KAUA,SAAAC,EAAAC,EAAAnL,GACA,OAAA2K,EAAAK,QARA,OAAAC,KAAA9E,SAAuEuE,EAAA,EAAWvE,SAClF8E,EAAA,IAAAG,WAA0CV,EAAA,EAAWvE,SAGrD8E,GAIAI,SAAAF,IAAAnL,IAGA,IAAAsL,EAAA,KAEA,SAAAC,IAKA,OAJA,OAAAD,KAAAnF,SAA2EuE,EAAA,EAAWvE,SACtFmF,EAAA,IAAAlF,aAA8CsE,EAAA,EAAWvE,SAGzDmF,EAGA,IAAAE,EAAA,EAEA,SAAAC,EAAAC,EAAAC,GACA,IAAAR,EAAAQ,EAAA,EAAAD,EAAA9N,QAGA,OAFA2N,IAAAK,IAAAF,EAAAP,EAAA,GACAK,EAAAE,EAAA9N,OACAuN,EAMO,IAAArD,EAAA,WACP,SAAAA,IACItJ,OAAAgM,EAAA,EAAAhM,CAAekC,KAAAoH,GAuDnB,OApDEtJ,OAAAiM,EAAA,EAAAjM,CAAYsJ,EAAA,EACdrG,IAAA,OACAvF,MAAA,WACA,IAAAiP,EAAAzK,KAAAyK,IACAzK,KAAAyK,IAAA,EAEMT,EAAA,EAAuCS,KAQ1C,CACH1J,IAAA,YASAvF,MAAA,SAAA2P,EAAAC,EAAAC,EAAAC,EAAA3C,GACA,IACA,IAAA4C,EAAAR,EAAAI,EAA+CnB,EAAA,GAC/CwB,EAAAV,EACAW,EAAAV,EAAApC,EAA8CqB,EAAA,GAC9C0B,EAAAZ,EACQd,EAAA,EAAsChK,KAAAyK,IAAAc,EAAAC,EAAAJ,EAAAC,EAAAC,EAAAG,EAAAC,GACvC,QACP/C,EAAAuC,IAAAL,IAAAF,SAAAc,EAAA,EAAAA,EAAA,EAAAC,IAEQ1B,EAAA,EAAoByB,EAAA,EAAAC,OAGzB,EACH3K,IAAA,SACAvF,MAAA,SAAAiP,GACA,IAAAkB,EAAA7N,OAAA8N,OAAAxE,EAAArJ,WAEA,OADA4N,EAAAlB,MACAkB,IAEG,CACH5K,IAAA,MACAvF,MAAA,SAAAqQ,EAAAC,GACA,IAAAC,EAAgB/B,EAAA,EAAgC6B,EAAAC,GAChD,OAAA1E,EAAA4E,OAAAD,OAIA3E,EAzDO,GA8DAC,EAAA,WACP,SAAAA,IACIvJ,OAAAgM,EAAA,EAAAhM,CAAekC,KAAAqH,GAuDnB,OApDEvJ,OAAAiM,EAAA,EAAAjM,CAAYuJ,EAAA,EACdtG,IAAA,OACAvF,MAAA,WACA,IAAAiP,EAAAzK,KAAAyK,IACAzK,KAAAyK,IAAA,EAEMT,EAAA,EAA8BS,KAQjC,CACH1J,IAAA,YASAvF,MAAA,SAAA2P,EAAAC,EAAAC,EAAAC,EAAA3C,GACA,IACA,IAAA4C,EAAAR,EAAAI,EAA+CnB,EAAA,GAC/CwB,EAAAV,EACAW,EAAAV,EAAApC,EAA8CqB,EAAA,GAC9C0B,EAAAZ,EACQd,EAAA,EAA6BhK,KAAAyK,IAAAc,EAAAC,EAAAJ,EAAAC,EAAAC,EAAAG,EAAAC,GAC9B,QACP/C,EAAAuC,IAAAL,IAAAF,SAAAc,EAAA,EAAAA,EAAA,EAAAC,IAEQ1B,EAAA,EAAoByB,EAAA,EAAAC,OAGzB,EACH3K,IAAA,SACAvF,MAAA,SAAAiP,GACA,IAAAkB,EAAA7N,OAAA8N,OAAAvE,EAAAtJ,WAEA,OADA4N,EAAAlB,MACAkB,IAEG,CACH5K,IAAA,MACAvF,MAAA,SAAAqQ,EAAAC,GACA,IAAAC,EAAgB/B,EAAA,EAAuB6B,EAAAC,GACvC,OAAAzE,EAAA2E,OAAAD,OAIA1E,EAzDO,GA2DAwC,EAAA,SAAAoC,EAAAC,GACP,UAAAC,MAAA3B,EAAAyB,EAAAC","file":"static/js/3.328bab81.chunk.js","sourcesContent":["import React from 'react';\n\nimport { PRIMARY, PRIMARY_TEXT } from '../../constants/colors';\n\nexport default ({ onClick, loading }) => {\n  return (\n    <div className=\"header\" style={{backgroundColor: PRIMARY, color: PRIMARY_TEXT}}>\n      Pitch Detector\n    </div>\n  )\n}\n","export const BACKGROUND = \"#F5F5F5\";\n\nexport const PRIMARY = \"#3f51b5\";\nexport const PRIMARY_LIGHT = \"#757de8\";\nexport const PRIMARY_DARK = \"#002984\";\nexport const PRIMARY_TEXT = \"#ffffff\";\n\nexport const SECONDARY = \"#9c27b0\";\nexport const SECONDARY_LIGHT = \"#d05ce3\";\nexport const SECONDARY_DARK = \"#6a0080\";\nexport const SECONDARY_TEXT = \"#ffffff\";\n","import React from 'react';\n\nimport { BACKGROUND, PRIMARY, PRIMARY_LIGHT, PRIMARY_TEXT } from '../../constants/colors';\n\nimport PlayIcon from './play.svg';\n\nexport default ({ detectorName, sampleRate, windowSize, clarityThreshold, onParamChange, onStart, loading }) => {\n  return (\n    <div className=\"full\" style={{backgroundColor: BACKGROUND, position: 'relative'}}>\n      <div className=\"content\" style={{textAlign: 'center'}}>\n        <h2>\n          A Rust + WebAssembly Pitch Detector\n        </h2>\n\n        <h3>\n          Author\n        </h3>\n        <span>\n          Alessandro Genova\n        </span>\n\n        <h3>\n          Core Library\n        </h3>\n        <span>\n          <a href=\"https://github.com/alesgenova/pitch-detection\" target=\"_blank\">Source</a>\n          <br/>\n          (rust)\n        </span>\n\n        <h3>\n          Demo App\n        </h3>\n        <span>\n          <a href=\"https://github.com/alesgenova/pitch-detection-app\" target=\"_blank\">Source</a>\n          <br/>\n          (wasm, react)\n        </span>\n\n        <br/>\n\n        <h3>\n          Detector\n        </h3>\n        <select value={detectorName} onChange={(e) => {onParamChange('detectorName', e.target.value)}}>\n          <option value=\"mcleod\">McLeod</option>\n          <option value=\"autocorrelation\">Autocorrelation</option>\n        </select>\n\n        <h3>\n          Sample Rate\n        </h3>\n        <select value={sampleRate} onChange={(e) => {onParamChange('sampleRate', e.target.value)}}>\n          <option value={11025}>11025 Hz</option>\n          <option value={22050}>22050 Hz</option>\n          <option value={44100}>44100 Hz</option>\n          <option value={48000}>48000 Hz</option>\n        </select>\n\n        <h3>\n          Window Size\n        </h3>\n        <select value={windowSize} onChange={(e) => {onParamChange('windowSize', e.target.value)}}>\n          <option value={512}>512 samples</option>\n          <option value={1024}>1024 samples</option>\n          <option value={2048}>2048 samples</option>\n          <option value={4096}>4096 samples</option>\n        </select>\n\n        <h3>\n          Clarity Threshold\n        </h3>\n        <input value={clarityThreshold} type=\"range\" min={0.0} max={1.0} step={0.01} onChange={(e) => {onParamChange('clarityThreshold', e.target.value)}}/>\n        <br/>\n        ({clarityThreshold})\n\n      </div>\n      <div className=\"floating-container-center\">\n        <button\n          disabled={loading}\n          onClick={onStart}\n          className=\"floating-button-large\"\n          style={{backgroundColor: loading ? PRIMARY_LIGHT : PRIMARY, color: PRIMARY_TEXT}}\n        >\n          <ion-icon src={PlayIcon}/>\n        </button>\n      </div>\n    </div>\n  )\n}\n","export var NOTE_STRINGS = [\"C\", \"Db\", \"D\", \"Eb\", \"E\", \"F\", \"Gb\", \"G\", \"Ab\", \"A\", \"Bb\", \"B\"];\nexport var OCTAVE_COLORS = [[121, 85, 72], [158, 158, 158], [96, 125, 139], [76, 175, 80], [244, 67, 54], [33, 150, 243], [0, 150, 136], [255, 235, 59], [0, 188, 212]];","import { OCTAVE_COLORS } from '../constants';\nexport function noteFromPitch(frequency) {\n  var noteNum = 12 * (Math.log(frequency / 440) / Math.log(2));\n  return Math.round(noteNum) + 69;\n}\nexport function frequencyFromNoteNumber(note) {\n  return 440 * Math.pow(2, (note - 69) / 12);\n}\nexport function centsOffFromPitch(frequency, note) {\n  return Math.floor(1200 * Math.log(frequency / frequencyFromNoteNumber(note)) / Math.log(2));\n}\nexport function colorFromNote(note) {\n  var octave = Math.floor(note / 12) - 1;\n  var idx = Math.min(octave, OCTAVE_COLORS.length - 1);\n  idx = Math.max(0, idx);\n  return OCTAVE_COLORS[idx];\n}","import _classCallCheck from \"/home/alessandro/personal/sources/pitch-detection-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/alessandro/personal/sources/pitch-detection-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport { scaleLinear } from 'd3-scale';\nimport { NOTE_STRINGS } from '../constants';\nimport { noteFromPitch, colorFromNote, centsOffFromPitch } from '../utils';\n\nvar PitchDisplay = /*#__PURE__*/function () {\n  function PitchDisplay(container) {\n    var timeSpan = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 15000;\n    var timeOffset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 7000;\n\n    _classCallCheck(this, PitchDisplay);\n\n    this.frequencies = [];\n    this.background = '#efefef';\n    this.highlight = '#888888';\n    this.container = container;\n    this.container.style.position = \"relative\";\n    var canvasStyle = \"position: absolute; width: 100%; height: 100%;\";\n    this.bgCanvas = document.createElement(\"canvas\");\n    this.bgCanvas.setAttribute(\"style\", canvasStyle);\n    this.bgContext = this.bgCanvas.getContext('2d');\n    this.noteCanvas = document.createElement(\"canvas\");\n    this.noteCanvas.setAttribute(\"style\", canvasStyle);\n    this.noteContext = this.noteCanvas.getContext('2d');\n    this.container.appendChild(this.bgCanvas);\n    this.container.appendChild(this.noteCanvas);\n    this.timeSpan = timeSpan;\n    this.timeOffset = timeOffset;\n    this.resize();\n  }\n\n  _createClass(PitchDisplay, [{\n    key: \"resize\",\n    value: function resize() {\n      var w = this.container.clientWidth;\n      var h = this.container.clientHeight;\n      this.bgCanvas.width = w;\n      this.bgCanvas.height = h;\n      this.noteCanvas.width = w;\n      this.noteCanvas.height = h;\n      this.scaleX = scaleLinear().domain([-this.timeOffset, -this.timeOffset + this.timeSpan]).range([0, w]);\n      var margin = h / (NOTE_STRINGS.length + 1);\n      this.scaleY = scaleLinear().domain([0, NOTE_STRINGS.length - 1]).range([h - margin, margin]);\n      this.render();\n    }\n  }, {\n    key: \"pushFrequency\",\n    value: function pushFrequency(frequency) {\n      this.frequencies.push(frequency);\n    }\n  }, {\n    key: \"cleanupFrequencies\",\n    value: function cleanupFrequencies() {\n      var _this = this;\n\n      // Throw away the frequencies that are out of the current display window\n      this.frequencies = this.frequencies.filter(function (val) {\n        return _this.now - val.time < _this.timeOffset;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var full = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      this.now = new Date().getTime();\n      this.cleanupFrequencies();\n\n      if (full) {\n        this.drawBackground();\n      }\n\n      this.drawNotes();\n    }\n  }, {\n    key: \"setBackgroundColor\",\n    value: function setBackgroundColor(color) {\n      this.background = color;\n      this.drawBackground();\n    }\n  }, {\n    key: \"setHighlightColor\",\n    value: function setHighlightColor(color) {\n      this.highlight = color;\n      this.drawBackground();\n    }\n  }, {\n    key: \"drawBackground\",\n    value: function drawBackground() {\n      var w = this.bgCanvas.width;\n      var h = this.bgCanvas.height;\n      this.bgContext.fillStyle = this.background;\n      this.bgContext.clearRect(0, 0, w, h);\n      this.bgContext.fillRect(0, 0, w, h);\n\n      for (var i = 0; i < NOTE_STRINGS.length; ++i) {\n        var y = this.scaleY(i);\n        this.bgContext.fillStyle = this.highlight + '55';\n        this.bgContext.fillRect(0, y, w, 1);\n        this.bgContext.fillStyle = this.highlight;\n        this.bgContext.font = '14px Sans';\n        this.bgContext.fillText(NOTE_STRINGS[i], this.scaleX(0) + 20, y - 2);\n        this.bgContext.fillText(NOTE_STRINGS[i], 20, y - 2);\n      }\n\n      this.bgContext.fillStyle = this.highlight + '55';\n      this.bgContext.fillRect(this.scaleX(0), 0, 1, h);\n    }\n  }, {\n    key: \"drawNotes\",\n    value: function drawNotes() {\n      var w = this.noteCanvas.width;\n      var h = this.noteCanvas.height;\n      this.noteContext.clearRect(0, 0, w, h);\n      this.noteContext.beginPath();\n      this.noteContext.strokeStyle = 'rgba(0, 0, 0, 0.1)'; // Calculate notes and colors from frequencies\n\n      var notes = [];\n\n      var _iterator = _createForOfIteratorHelper(this.frequencies),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var frequency = _step.value;\n          var t = frequency.time;\n          var f = frequency.frequency;\n          var c = frequency.clarity;\n\n          var _note = noteFromPitch(f);\n\n          var centsOff = centsOffFromPitch(f, _note);\n\n          var _x2 = this.scaleX(t - this.now);\n\n          var _y2 = this.scaleY(_note % 12 + centsOff / 100);\n\n          var _color = colorFromNote(_note);\n\n          notes.push({\n            time: t,\n            x: _x2,\n            y: _y2,\n            clarity: c,\n            color: _color\n          });\n        } // Draw lines\n\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      var timeCutoff = 500;\n      this.noteContext.beginPath();\n\n      for (var i = 1; i < notes.length; ++i) {\n        var _notes$i = notes[i],\n            x = _notes$i.x,\n            y = _notes$i.y,\n            time = _notes$i.time;\n        var prevTime = notes[i - 1].time;\n\n        if (time - prevTime > timeCutoff) {\n          this.noteContext.stroke();\n          this.noteContext.beginPath();\n          this.noteContext.moveTo(x, y);\n        } else {\n          this.noteContext.lineTo(x, y);\n        }\n      }\n\n      this.noteContext.stroke(); // Draw circles\n\n      for (var _i = 0, _notes = notes; _i < _notes.length; _i++) {\n        var note = _notes[_i];\n        var _x = note.x,\n            _y = note.y,\n            clarity = note.clarity,\n            color = note.color;\n        this.noteContext.fillStyle = \"rgba(\".concat(color[0], \", \").concat(color[1], \", \").concat(color[2], \", \").concat(clarity * 0.5, \")\");\n        this.noteContext.beginPath();\n        this.noteContext.arc(_x, _y, 3, 0, Math.PI * 2);\n        this.noteContext.fill();\n      }\n    }\n  }]);\n\n  return PitchDisplay;\n}();\n\nexport { PitchDisplay };","import React, { Component } from 'react';\n\nimport { PitchDisplay } from 'pitch-display';\n\nimport { BACKGROUND, SECONDARY, SECONDARY_LIGHT, SECONDARY_TEXT, PRIMARY_LIGHT } from '../../constants/colors';\nimport StopIcon from './stop.svg';\n\nclass PitchComponent extends Component {\n  audioContext;\n  mediaStreamSource;\n  analyser;\n  signal;\n  detector;\n  result;\n  buffer;\n  quit = false;\n  displayElement;\n  pitchDisplay;\n\n  componentDidMount() {\n    console.log('PitchComponent did mount', PitchDisplay);\n    this.pitchDisplay = new PitchDisplay(this.displayElement, 6000, 5000);\n    this.pitchDisplay.setBackgroundColor(BACKGROUND);\n    const { stream, detectorClass, windowSize } = this.props;\n    this.detector = detectorClass.new(windowSize, windowSize / 2);\n    this.buffer = new Float32Array( windowSize );\n    this.result = new Float32Array(2);\n    this.audioContext = new AudioContext();\n    // Create an AudioNode from the stream.\n    this.mediaStreamSource = this.audioContext.createMediaStreamSource(stream);\n    // Connect it to the destination.\n    this.analyser = this.audioContext.createAnalyser();\n    this.analyser.fftSize = windowSize;\n    this.mediaStreamSource.connect( this.analyser );\n    window.addEventListener('resize', this.onResize);\n    this.mainLoop();\n  }\n\n  componentWillUnmount() {\n    console.log('PitchComponent will unmount');\n    window.removeEventListener('resize', this.onResize);\n    this.quit = true;\n  }\n\n  mainLoop = () => {\n    if (this.quit) {\n      return;\n    }\n    requestAnimationFrame(this.mainLoop);\n    this.updatePitch();\n  }\n\n  onResize = () => {\n    this.pitchDisplay.resize();\n  }\n\n  updatePitch() {\n    const { sampleRate, powerThreshold, clarityThreshold } = this.props;\n    this.analyser.getFloatTimeDomainData(this.buffer);\n    this.detector.get_pitch(this.buffer, sampleRate, powerThreshold, clarityThreshold, this.result);\n    const [frequency, clarity] = this.result;\n    if (frequency > 0) {\n      const time = (new Date()).getTime();\n      this.pitchDisplay.pushFrequency({frequency, clarity, time});\n    }\n    this.pitchDisplay.render(false);\n  }\n\n  render() {\n    const { onStop } = this.props;\n    return (\n      <div className=\"full\" style={{position: 'relative'}}>\n        <div className=\"full\" style={{position: 'relative'}}\n          ref={ref => {this.displayElement = ref;}}\n        />\n        <div className=\"floating-container\">\n          <button\n            onClick={onStop}\n            className=\"floating-button\"\n            style={{backgroundColor: SECONDARY, color: SECONDARY_TEXT}}\n          >\n            <ion-icon src={StopIcon}/>\n          </button>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default PitchComponent;\n","import React, { Component, Fragment } from 'react';\nimport './App.css';\n\nimport { AutocorrelationDetector, McLeodDetector } from 'pitch-detection-wasm';\n\nimport HeaderComponent from './components/header';\nimport LoaderComponent from './components/loader';\nimport PitchComponent from './components/pitch';\n\nfunction getDetectorClass(name) {\n  switch(name) {\n    case 'autocorrelation': {\n      return AutocorrelationDetector;\n    }\n\n    case 'mcleod': {\n      return McLeodDetector;\n    }\n\n    default: {\n      return McLeodDetector;\n    }\n  }\n}\n\nclass App extends Component {\n  POWER_THRESHOLD = 0.15;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      loaded: false,\n      stream: null,\n      detectorName: 'mcleod',\n      sampleRate: 44100,\n      windowSize: 1024,\n      clarityThreshold: 0.6\n    }\n  }\n\n  onStart = () => {\n    this.setState(state => {\n      state.loading = true;\n      return state;\n    });\n\n    const gotStream = (stream) => {\n      this.setState(state => {\n        state.loading = false;\n        state.loaded = true;\n        state.stream = stream;\n        return state;\n      });\n    }\n\n    const gotError = (e) => {\n      console.log(e);\n      this.setState(state => {\n        state.loading = false;\n        state.stream = null;\n        return state;\n      });\n    }\n\n    const options = {\n      audio: {\n        echoCancellation: true,\n        autoGainControl: true,\n        sampleRate: this.SAMPLE_RATE\n      }\n    }\n\n    navigator.mediaDevices.getUserMedia(options )\n      .then(gotStream)\n      .catch(gotError);\n  }\n\n  onStop = () => {\n    const { stream } = this.state;\n    if (stream) {\n      for (let track of stream.getTracks()) {\n        track.stop();\n      }\n    }\n    this.setState(state => {\n      state.loaded = false;\n      state.stream = null;\n      return state;\n    })\n  }\n\n  onParamChange = (key, value) => {\n    this.setState(state => {\n      state[key] = value;\n      return state;\n    })\n  }\n\n  render() {\n    const {\n      detectorName,\n      sampleRate,\n      windowSize,\n      clarityThreshold,\n      loading,\n      loaded,\n      stream\n    } = this.state;\n    return (\n      <div className=\"app\">\n        <HeaderComponent />\n\n        <div className=\"content-container\">\n          \n          {!loaded &&\n          <LoaderComponent\n            detectorName={detectorName}\n            sampleRate={sampleRate}\n            windowSize={windowSize}\n            clarityThreshold={clarityThreshold}\n            onParamChange={this.onParamChange}\n            onStart={this.onStart}\n            loading={loading}\n          />\n          }\n\n          {loaded &&\n          <PitchComponent\n            stream={stream}\n            detectorClass={getDetectorClass(detectorName)}\n            sampleRate={sampleRate}\n            windowSize={windowSize}\n            powerThreshold={this.POWER_THRESHOLD}\n            clarityThreshold={clarityThreshold}\n            onStop={this.onStop}\n          />        \n          }\n        \n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = __webpack_public_path__ + \"static/media/play.7674a1b6.svg\";","module.exports = __webpack_public_path__ + \"static/media/stop.292a58fa.svg\";","import _classCallCheck from \"/home/alessandro/personal/sources/pitch-detection-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/alessandro/personal/sources/pitch-detection-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport * as wasm from './pitch_detection_wasm_bg.wasm';\nvar lTextDecoder = typeof TextDecoder === 'undefined' ? (0, module.require)('util').TextDecoder : TextDecoder;\nvar cachedTextDecoder = new lTextDecoder('utf-8', {\n  ignoreBOM: true,\n  fatal: true\n});\ncachedTextDecoder.decode();\nvar cachegetUint8Memory0 = null;\n\nfunction getUint8Memory0() {\n  if (cachegetUint8Memory0 === null || cachegetUint8Memory0.buffer !== wasm.memory.buffer) {\n    cachegetUint8Memory0 = new Uint8Array(wasm.memory.buffer);\n  }\n\n  return cachegetUint8Memory0;\n}\n\nfunction getStringFromWasm0(ptr, len) {\n  return cachedTextDecoder.decode(getUint8Memory0().subarray(ptr, ptr + len));\n}\n\nvar cachegetFloat32Memory0 = null;\n\nfunction getFloat32Memory0() {\n  if (cachegetFloat32Memory0 === null || cachegetFloat32Memory0.buffer !== wasm.memory.buffer) {\n    cachegetFloat32Memory0 = new Float32Array(wasm.memory.buffer);\n  }\n\n  return cachegetFloat32Memory0;\n}\n\nvar WASM_VECTOR_LEN = 0;\n\nfunction passArrayF32ToWasm0(arg, malloc) {\n  var ptr = malloc(arg.length * 4);\n  getFloat32Memory0().set(arg, ptr / 4);\n  WASM_VECTOR_LEN = arg.length;\n  return ptr;\n}\n/**\n*/\n\n\nexport var AutocorrelationDetector = /*#__PURE__*/function () {\n  function AutocorrelationDetector() {\n    _classCallCheck(this, AutocorrelationDetector);\n  }\n\n  _createClass(AutocorrelationDetector, [{\n    key: \"free\",\n    value: function free() {\n      var ptr = this.ptr;\n      this.ptr = 0;\n\n      wasm.__wbg_autocorrelationdetector_free(ptr);\n    }\n    /**\n    * @param {number} size\n    * @param {number} padding\n    * @returns {AutocorrelationDetector}\n    */\n\n  }, {\n    key: \"get_pitch\",\n\n    /**\n    * @param {Float32Array} signal\n    * @param {number} sample_rate\n    * @param {number} power_threshold\n    * @param {number} clarity_threshold\n    * @param {Float32Array} pitch\n    */\n    value: function get_pitch(signal, sample_rate, power_threshold, clarity_threshold, pitch) {\n      try {\n        var ptr0 = passArrayF32ToWasm0(signal, wasm.__wbindgen_malloc);\n        var len0 = WASM_VECTOR_LEN;\n        var ptr1 = passArrayF32ToWasm0(pitch, wasm.__wbindgen_malloc);\n        var len1 = WASM_VECTOR_LEN;\n        wasm.autocorrelationdetector_get_pitch(this.ptr, ptr0, len0, sample_rate, power_threshold, clarity_threshold, ptr1, len1);\n      } finally {\n        pitch.set(getFloat32Memory0().subarray(ptr1 / 4, ptr1 / 4 + len1));\n\n        wasm.__wbindgen_free(ptr1, len1 * 4);\n      }\n    }\n  }], [{\n    key: \"__wrap\",\n    value: function __wrap(ptr) {\n      var obj = Object.create(AutocorrelationDetector.prototype);\n      obj.ptr = ptr;\n      return obj;\n    }\n  }, {\n    key: \"new\",\n    value: function _new(size, padding) {\n      var ret = wasm.autocorrelationdetector_new(size, padding);\n      return AutocorrelationDetector.__wrap(ret);\n    }\n  }]);\n\n  return AutocorrelationDetector;\n}();\n/**\n*/\n\nexport var McLeodDetector = /*#__PURE__*/function () {\n  function McLeodDetector() {\n    _classCallCheck(this, McLeodDetector);\n  }\n\n  _createClass(McLeodDetector, [{\n    key: \"free\",\n    value: function free() {\n      var ptr = this.ptr;\n      this.ptr = 0;\n\n      wasm.__wbg_mcleoddetector_free(ptr);\n    }\n    /**\n    * @param {number} size\n    * @param {number} padding\n    * @returns {McLeodDetector}\n    */\n\n  }, {\n    key: \"get_pitch\",\n\n    /**\n    * @param {Float32Array} signal\n    * @param {number} sample_rate\n    * @param {number} power_threshold\n    * @param {number} clarity_threshold\n    * @param {Float32Array} pitch\n    */\n    value: function get_pitch(signal, sample_rate, power_threshold, clarity_threshold, pitch) {\n      try {\n        var ptr0 = passArrayF32ToWasm0(signal, wasm.__wbindgen_malloc);\n        var len0 = WASM_VECTOR_LEN;\n        var ptr1 = passArrayF32ToWasm0(pitch, wasm.__wbindgen_malloc);\n        var len1 = WASM_VECTOR_LEN;\n        wasm.mcleoddetector_get_pitch(this.ptr, ptr0, len0, sample_rate, power_threshold, clarity_threshold, ptr1, len1);\n      } finally {\n        pitch.set(getFloat32Memory0().subarray(ptr1 / 4, ptr1 / 4 + len1));\n\n        wasm.__wbindgen_free(ptr1, len1 * 4);\n      }\n    }\n  }], [{\n    key: \"__wrap\",\n    value: function __wrap(ptr) {\n      var obj = Object.create(McLeodDetector.prototype);\n      obj.ptr = ptr;\n      return obj;\n    }\n  }, {\n    key: \"new\",\n    value: function _new(size, padding) {\n      var ret = wasm.mcleoddetector_new(size, padding);\n      return McLeodDetector.__wrap(ret);\n    }\n  }]);\n\n  return McLeodDetector;\n}();\nexport var __wbindgen_throw = function __wbindgen_throw(arg0, arg1) {\n  throw new Error(getStringFromWasm0(arg0, arg1));\n};"],"sourceRoot":""}